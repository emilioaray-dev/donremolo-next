import { GetStaticPaths, GetStaticProps, InferGetStaticPropsType } from "next";

import Image from "next/image";
import Link from "next/link";
import { useRouter } from "next/router";
import slugify from "slugify";

type categories = {
  id: string;
  categoria: string;
  urlImagen: string;
};

export const getStaticProps: GetStaticProps = async (context) => {
  // Res Lista Categoria (`http://${url}/api/dataCategorias`);
  const res = await fetch(
    `https://donremolo-next.vercel.app/api/dataCategorias`
  );
  // Lista Categoria to Json
  const categories: [categories] = await res.json();

  const ok = categories.map((l: any) => slugify(l.categoria, { lower: true }));
  // console.log (ok)
  console.log(categories);
  return {
    props: {
      categories,
    },
    revalidate: 10, // In 10 seconds
  };
};

export default function Category({
  categories,
}: InferGetStaticPropsType<typeof getStaticProps>) {
  const router = useRouter();

  return (
    <>
      <section className="containerCardCategories">
        <div className="cardCategories__grid">
          {categories.map((listC) => {
            <div key={listC.id}>
              <Link href={`/${slugify(listC.categoria, { lower: true })}`}>
                <a>
                  <div className="cardCategories">
                    <div className="cardCategories--effectTranslateY">
                      <picture className="cardCategories__imgGrid">
                        <Image
                          src={`${listC.urlImagen}`}
                          alt={`Imagen de ${listC.categoria}`}
                          width={512}
                          height={384}
                          layout="responsive"
                          priority
                        />
                      </picture>
                      <h2 className="titleCategories">{listC.categoria}</h2>
                    </div>
                  </div>
                </a>
              </Link>
            </div>;
          })}
        </div>
      </section>
      {/* Style of Component-----------------------------------*/}
      <style jsx>{`
        @media only screen and (min-width: 768px) {
          .cardCategories__grid {
            grid-template-columns: auto auto auto auto !important;
          }
        }
        @media (max-width: 768px) and (orientation: landscape) {
          .cardCategories__grid {
            grid-template-columns: auto auto auto auto !important;
          }
        }
        .cardCategories__grid {
          display: grid;
          grid-template-columns: auto auto;
          justify-content: center;
        }
        .containerCardCategories {
          position: absolute;
          width: 100vw;
          top: 50%;
          transform: translateY(-38%);
        }

        .cardCategories {
          min-width: 8rem;
          max-width: 20rem;
          box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.15);
          border-radius: 0.625rem;
          margin: 2rem 1rem 1rem 1rem;
          background-color: var(--brandColorWhite);
          height: 7.2rem;
        }

        .cardCategories--effectTranslateY {
          display: grid;
          transform: translateY(-30%);
          justify-items: center;
        }

        .cardCategories__imgGrid {
          display: grid;
          min-height: 6rem;
          padding: 0rem 0.5rem;
          width: 100%;
        }

        .titleCategories {
          font-family: var(--Home-Card-fontFamily);
          font-size: 0.875rem;
        }
      `}</style>
    </>
  );
}
